<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Primary SEO -->
  <title>Bhapstar Astrophotography — Fragments of the Universe</title>
  <meta name="description" content="Deep-sky astrophotography by Bhapinder (Bobby) Singh. Nebulae, galaxies, star clusters and more — captured through patient long-exposure imaging under dark skies." />
  <meta name="author" content="Bhapinder Singh" />

  <!-- Open Graph (social sharing) -->
  <meta property="og:type"        content="website" />
  <meta property="og:title"       content="Bhapstar Astrophotography — Fragments of the Universe" />
  <meta property="og:description" content="Nebulae, galaxies, star clusters and deep-sky objects — captured slowly through patient hours of long exposure under dark skies." />
  <meta property="og:image"       content="images/RN.jpg" />
  <meta property="og:url"         content="https://bhapstar.github.io/bhapstar-astro/" />

  <!-- Twitter Card -->
  <meta name="twitter:card"        content="summary_large_image" />
  <meta name="twitter:title"       content="Bhapstar Astrophotography" />
  <meta name="twitter:description" content="Nebulae, galaxies and deep-sky objects captured through patient long-exposure imaging." />
  <meta name="twitter:image"       content="images/RN.jpg" />

  <!-- Google Search Console verification -->
  <meta name="google-site-verification" content="QnMwC-ycqBRx8M1hdYQCTaO02X3GASV9P1Kmmi6QOrI" />

  <!-- Cloudflare Web Analytics -->
  <script defer src="https://static.cloudflareinsights.com/beacon.min.js"
    data-cf-beacon='{"token":"b3353c7dd8764a64baee57fd09c3dbb9"}'></script>

  <!-- Preconnect for performance -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

  <link rel="stylesheet" href="styles.css" />
</head>
<body>

<!-- ── Header (injected by partials.js) ── -->
<div id="siteHeader"></div>

<main>
  <!-- ─────────────────────────────
       HERO
       Full-viewport section with
       background slideshow + star canvas
  ───────────────────────────────── -->
  <section class="hero protect-zone" aria-label="Hero section">

    <!-- Background crossfade layers (JS swaps .is-on class) -->
    <div class="hero-bg" aria-hidden="true">
      <div class="hero-bg-layer layer-a"></div>
      <div class="hero-bg-layer layer-b"></div>
    </div>

    <!-- Foreground content -->
    <div class="content wrap">
      <h1>Fragments of the Universe</h1>
      <h1 class="hero-byline">by Bhapstar Astrophotography</h1>

      <p class="lead">
        Nebulae, galaxies, star clusters and deep-sky objects — captured slowly
        through patient hours of long exposure under dark skies, pulling colour,
        dust and structure from the edge of space.
      </p>

      <div class="actions">
        <a class="btn primary" href="gallery.html">View the gallery</a>
        <a class="btn"         href="prints.html">Print enquiries</a>
      </div>
    </div>

  </section>
</main>

<!-- ── About (integrated from about.html) ── -->
<section class="section index-about-section">
  <div class="wrap">
    <div class="section-head">
      <h2>About</h2>
    </div>

    <div class="cols">
      <div class="panel about-panel">

        <div class="about-header">
          <img
            src="images/me/bobby.jpg"
            alt="Portrait of Bhapinder (Bobby) Singh"
            class="about-photo"
            loading="lazy"
          />
        </div>

        <p>
          Hi, I'm Bhapinder (Bobby) Singh, an astrophotographer focused on capturing
          the quiet structure of the deep night sky. My work centres on imaging nebulae,
          star-forming regions, and distant galaxies — objects whose light has travelled
          for thousands or millions of years before reaching Earth. I also image the Moon,
          star trails and our Milky Way.
        </p>
        <p>
          I like images that feel honest. They may not be perfect, but they are real
          <strong><em>Fragments of the Universe</em></strong>, showing the structure,
          dust lanes, shock fronts and faint halos of these immense astronomical objects —
          shaped through careful processing that allows faint signal to emerge from the noise.
        </p>
        <p>
          Most images begin the same way: checking weather conditions, waiting for a
          workable night, and committing the hours needed to see what the data reveals.
        </p>
        <p>
          I'm not trying to "make space look dramatic". I'm just trying to make it look true.
        </p>
        <p>
          Some nights are a win. Some nights you pack up early because the sky won't
          cooperate. Either way, it's part of the same practice: showing up, collecting
          clean signal, and letting the object reveal itself on its own terms. This site
          is a record of that process — image by image.
        </p>

        <div class="astro-divider" aria-hidden="true">
          <span>✦ ✦ ✦</span>
        </div>

        <!-- Support panel -->
        <div class="support-panel support-panel--about panel">
          <div class="support-left">
            <h2 class="support-title">Support my work</h2>
            <p class="support-text">
              If you enjoy my astrophotography or the outreach work I do, you're
              welcome to support the time and effort behind it.
            </p>
          </div>
          <div class="support-right">
            <a
              href="https://www.buymeacoffee.com/bhapstar_astro"
              target="_blank"
              rel="noopener noreferrer"
              class="btn primary support-btn"
            >☕ Support my work</a>
          </div>
        </div>

      </div>
    </div>
  </div>
</section>

<!-- ── Contact ── -->
<section class="section contact-section index-contact-section">
  <div class="wrap">
    <div class="cols">
      <div class="panel contact-panel">
        <div class="section-head">
          <h3>Contact &amp; Updates</h3>
        </div>

        <p class="contact-intro">
          If you'd like to be kept up to date when new images are added, or if you want
          to get in touch about my work, prints, gear or anything astro-related, please drop
          me a message here.
        </p>

        <!-- AJAX form submitted to Formspree -->
        <form class="contact-form" action="https://formspree.io/f/mjgwwblj" method="POST" novalidate>
          <input type="hidden" name="_subject" value="bhapstar — New website message" />
          <!-- Honeypot spam trap -->
          <input type="text" name="_gotcha" class="hidden" tabindex="-1" autocomplete="off" />

          <label>
            <span>Name</span>
            <input type="text" name="name" required autocomplete="name" />
          </label>

          <label>
            <span>Email</span>
            <input type="email" name="email" required autocomplete="email" />
          </label>

          <label>
            <span>Message</span>
            <textarea name="message" rows="5" required></textarea>
          </label>

          <button type="submit" class="btn primary">Send message</button>
        </form>
      </div>
    </div>
  </div>
</section>

<!-- ── Footer (injected by partials.js) ── -->
<div id="siteFooter"></div>

<!-- Toast notification -->
<div class="toast" id="toast" role="status" aria-live="polite"></div>

<!-- ─────────────────────────────────────────
     CONTACT FORM — AJAX SUBMIT
───────────────────────────────────────── -->
<script>
(function () {
  const form  = document.querySelector('form.contact-form');
  const toast = document.getElementById('toast');
  if (!form || !toast) return;

  function showToast(msg) {
    toast.textContent = msg;
    toast.classList.add('show');
    clearTimeout(showToast._t);
    showToast._t = setTimeout(() => toast.classList.remove('show'), 3200);
  }

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    if (!form.checkValidity()) { form.reportValidity(); return; }

    const btn = form.querySelector('button[type="submit"]');
    const originalText = btn.textContent;
    btn.textContent = 'Sending…';
    btn.disabled = true;

    try {
      const res = await fetch(form.action, {
        method: 'POST',
        headers: { 'Accept': 'application/json' },
        body: new FormData(form),
      });
      if (!res.ok) throw new Error('Bad response');
      form.reset();
      showToast('Thank you — your message has been sent. I\'ll get back to you as soon as possible.');
    } catch {
      showToast('Message sent — I\'ll get back to you as soon as possible.');
    } finally {
      btn.textContent = originalText;
      btn.disabled = false;
    }
  });
})();
</script>


<!-- ─────────────────────────────────────────
     HERO BACKGROUND SLIDESHOW
     - Fetches gallery-data.json as single source of truth
     - Randomises and cycles images every HOLD_MS
     - Crossfades between two layers (A / B)
     - Preloads upcoming images to avoid stutter
───────────────────────────────────────── -->
<script>
(async function () {
  const layerA = document.querySelector('.hero-bg .layer-a');
  const layerB = document.querySelector('.hero-bg .layer-b');
  if (!layerA || !layerB) return;

  function preload(src) {
    return new Promise((res, rej) => {
      const img = new Image();
      img.onload  = () => res(src);
      img.onerror = () => rej(src);
      img.src = src;
    });
  }

  function shuffle(arr) {
    return arr
      .map(v => ({ v, r: Math.random() }))
      .sort((a, b) => a.r - b.r)
      .map(x => x.v);
  }

  function getCoverFile(item) {
    if (item?.images?.length) return item.images[0].file;
    return item?.file;
  }

  let items = [];
  try {
    const res = await fetch('gallery-data.json', { cache: 'no-store' });
    if (!res.ok) throw new Error('HTTP ' + res.status);
    items = await res.json();
    if (!Array.isArray(items) || !items.length) throw new Error('Empty');
  } catch (e) {
    console.warn('Hero slideshow: could not load gallery data', e);
    return;
  }

  let playlist = shuffle(items.slice());
  let idx = 0;
  const HOLD_MS = 6000;

  function warmPreload() {
    [0, 1, 2].forEach(n => {
      const src = getCoverFile(playlist[(idx + n) % playlist.length]);
      if (src) { const im = new Image(); im.src = src; }
    });
  }

  function setLayer(layer, src) {
    layer.style.backgroundImage = `url("${CSS.escape ? CSS.escape(src).replace(/^#/, '') : src}")`;
    // Simpler, safer version:
    layer.style.backgroundImage = `url("${src}")`;
  }

  // Initial state
  setLayer(layerA, getCoverFile(playlist[idx]));
  layerA.classList.add('is-on');
  warmPreload();

  let onA = true;

  const reduceMotion =
    window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  if (reduceMotion || playlist.length <= 1) return;

  async function nextSlide() {
    idx = (idx + 1) >= playlist.length ? 0 : idx + 1;
    if (idx === 0) playlist = shuffle(items.slice());

    const nextSrc = getCoverFile(playlist[idx]);
    try { await preload(nextSrc); } catch { return; }

    const incoming = onA ? layerB : layerA;
    const outgoing = onA ? layerA : layerB;

    setLayer(incoming, nextSrc);
    incoming.classList.add('is-on');
    outgoing.classList.remove('is-on');

    onA = !onA;
    warmPreload();
  }

  setInterval(nextSlide, HOLD_MS);
})();
</script>

<script src="protect-images.js"></script>
<script src="partials/partials.js"></script>

</body>
</html>
