<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <!-- Mobile-friendly scaling -->
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Prints — bhapstar</title>

  <!-- Cloudflare Web Analytics (site traffic measurement) -->
  <!-- Cloudflare Web Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "b3353c7dd8764a64baee57fd09c3dbb9"}'></script><!-- End Cloudflare Web Analytics -->

  <!-- Shared site styling -->
  <link rel="stylesheet" href="styles.css" />
</head>

<body class="page-prints">

<!-- =========================
     Header / navigation
========================= -->
<div id="siteHeader"></div>

<!-- Support panel (kept near top so it’s visible before the enquiry builder) -->
<!-- KEEP: Support my work stays where it is -->
<section class="section support-wrap">
  <div class="wrap">
    <div class="panel support-panel">
      <div class="support-left">
        <h2 class="support-title">Support my work</h2>
        <p class="support-text">
          If you enjoy my astrophotography or the outreach work I do, you’re welcome to support the time and effort behind it by clicking the button here.
        </p>
      </div>

      <div class="support-right">
        <!-- External link: opens in a new tab -->
        <a
          href="https://www.buymeacoffee.com/bhapstar_astro"
          target="_blank"
          rel="noopener"
          class="btn primary support-btn"
        >
          ☕ Support my work
        </a>
      </div>
    </div>
  </div>
</section>

<main>
  <section class="section">
    <div class="wrap">

      <div class="section-head featured-head">
        <h2>Print enquiries</h2>
      </div>

      <!-- Main 1-col (mobile) / 2-col (desktop) prints layout wrapper -->
      <div class="prints-layout">

        <!-- LEFT: main content (how it works + enquiry form + framed mockup) -->
        <div class="prints-main">

          <!-- 1) HOW IT WORKS (quick steps) -->
          <div class="panel prints-panel">
            <h3>How it works</h3>

            <div class="steps">
              <div class="step">
                <div class="k">1</div>
                <h4>Choose an image</h4>
                <p>Pick from the <a href="gallery.html">gallery</a>, then select the image title in the enquiry builder.</p>
              </div>
              <div class="step">
                <div class="k">2</div>
                <h4>Select a format</h4>
                <p>A4 / A3 print, framed or unframed, or a high-resolution digital file.</p>
                <p class="helper">Repeat steps 1 and 2 as many times as needed.</p>
              </div>
              <div class="step">
                <div class="k">3</div>
                <h4>Send an enquiry</h4>
                <p>I’ll confirm availability, finish options, lead time, and delivery/collection based on your location.</p>
              </div>
            </div>
          </div>

          <!-- 2) BUILD YOUR ENQUIRY (Formspree form + live preview builder) -->
          <div class="panel prints-panel">
            <h3>Build your enquiry</h3>
            <p class="helper">Fill this in and submit your enquiry. I’ll get back to you as soon as possible.</p>

            <!-- Form submits to Formspree endpoint (AJAX submit handled in JS below) -->
            <form id="printsEnquiryForm" action="https://formspree.io/f/xykwwgvr" method="POST">
              <!-- Email subject line for inbound enquiries -->
              <input type="hidden" name="_subject" value="bhapstar — New print enquiry" />

              <!-- Honeypot spam trap (humans never fill this; bots often do) -->
              <input type="text" name="_gotcha" class="hidden" tabindex="-1" autocomplete="off" />

              <div class="picker" id="enquiryPicker">

                <!-- CONTACT -->
                <div class="row">
                  <label for="pName">Name</label>
                  <input id="pName" name="name" type="text" placeholder="Your name" required />
                </div>

                <div class="row">
                  <label for="pPhone">Phone</label>
                  <input id="pPhone" name="phone" type="tel" placeholder="Your phone number" required />
                </div>

                <div class="row">
                  <label for="pEmail">Email</label>
                  <input id="pEmail" name="email" type="email" placeholder="Your email address" required />
                </div>

                <!-- ITEMS (multi-item builder) -->
                <div class="row row-start">
                  <label>Items</label>
                  <div>
                    <!-- JS injects one or more .item-row blocks here -->
                    <div id="itemsWrap" class="items-area"></div>

                    <div class="items-controls">
                      <!-- Adds another item row (image + size + frame) -->
                      <button type="button" class="btn" id="addItemBtn">+ Add another image</button>
                    </div>

                    <!-- Hidden field included in form submission: plain-text summary of all items -->
                    <input type="hidden" id="itemsSummary" name="items_summary" value="">
                  </div>
                </div>

                <!-- DELIVERY + NOTES -->
                <div class="row">
                  <label for="pCity">Delivery location</label>
                  <input id="pCity" name="delivery_location" type="text" placeholder="Location" />
                </div>

                <div class="row">
                  <label for="pNotes">Notes</label>
                  <textarea id="pNotes" name="notes" placeholder="Any further information about your enquiry" rows="3"></textarea>
                </div>

                <!-- Calendar interest (optional add-on enquiry) -->
<!-- Calendar interest -->
<div class="row row-start">
  <label for="pCalendar">Calendar</label>

  <div>
    <!-- Checkbox is captured in live preview + submitted via Formspree -->
    <label class="checkline" for="pCalendar">
      <input id="pCalendar" name="calendar_interest" type="checkbox" value="Yes">
<span>
  Please click here if you would also like to enquire about a custom astrophotography calendar made from any 12 of my images of your choosing.
  <!-- Opens a modal preview (handled at end of file) -->
  <a href="#" class="faq-link" id="openCalendarExample">View example</a>
</span>
    </label>
  </div>
</div>

              </div>

              <div class="spacer-12" aria-hidden="true"></div>

              <!-- Live preview of the enquiry that will be sent (updated by build()) -->
              <div class="template-box">
                <pre id="enquiryPreview"></pre>
              </div>

              <div class="spacer-14" aria-hidden="true"></div>

              <div class="actions actions-left">
                <button class="btn primary" id="submitEnquiry" type="submit">Submit enquiry</button>
              </div>

              <p class="helper mt-10">
                Enquiry-based only — no checkout or online payments on this site.
              </p>

            </form>
          </div>

          <!-- 4) FRAMED MOCKUP (rotating preview tile) -->
          <div class="panel prints-panel">
            <h3>Framed mockup</h3>
            <p class="helper">A rotating preview of framed print styles.</p>

            <div class="grid grid-single framed-grid">
              <div class="card framed-tile" aria-hidden="false">
                <img id="framedPreviewImg" src="" alt="Framed print preview" loading="lazy" />
                <div class="cap">
                  <div class="t">Framed mockup</div>
                </div>
              </div>
            </div>

            <!-- JSON list of framed mockup image paths -->
            <script id="framedData" type="application/json">
            [
              "images/framed/1.jpg",
              "images/framed/2.jpg",
              "images/framed/3.jpg",
              "images/framed/4.jpg",
              "images/framed/5.jpg",
              "images/framed/1-1.jpg",
              "images/framed/2-2.jpg",
              "images/framed/3-3.jpg",
              "images/framed/4-4.jpg",
              "images/framed/5-5.jpg"
            ]
            </script>
          </div>

        </div>

        <!-- RIGHT: FAQ sidebar -->
        <aside class="prints-side">
          <div class="panel prints-panel">
            <h3>FAQ</h3>

            <div class="faq">
              <details class="faq-item">
                <summary>What print sizes are available?</summary>
                <p>Prints are available in A3 or A4 sizes.</p>
              </details>

              <details class="faq-item">
                <summary>What paper is used for printing?</summary>
                <p>Printed images will be supplied in premium glossy, 200gsm weighted, photo quality paper with advanced waterproof coating protecting your prints from moisture, fingerprints, and accidental spills, keeping every photo clean and sharp over time.</p>
              </details>

              <details class="faq-item">
                <summary>Can I have my print framed?</summary>
                <p>Yes, a high quality black frame can be supplied. Other frame colours are available by request.</p>
              </details>

              <details class="faq-item">
                <summary>How will the prints be shipped?</summary>
                <p>Unframed prints will be sent in a secure rolled mailing tube.<br>
                   Framed prints will be sent with a black frame with corner protectors.</p>
              </details>

              <details class="faq-item">
                <summary>How does the digital download work?</summary>
                <p>The high resolution digital file will be emailed to you.</p>
              </details>

              <details class="faq-item">
                <summary>Do you ship internationally?</summary>
                <p>It depends on destination and courier options. Tell me your location in the enquiry and I’ll confirm what’s possible.</p>
              </details>

              <details class="faq-item">
                <summary>Can I request a specific crop or aspect ratio?</summary>
                <p>Yes — in many cases I can prepare a crop that suits your chosen size. Mention it in the notes.</p>
              </details>

              <!-- Calendar FAQ entry includes an inline example image -->
<details class="faq-item" id="faq-calendar">

  <summary>What will the calendar look like?</summary>
  <p>
    The calendar will include 12 images from the gallery (chosen at random or by your choice), each with a short description of the target.
    It will also be pre-populated with key astronomical events and key dates.
  </p>
  <p class="helper mt-10">Example layout:</p>
  <img src="images/calendar-example.jpg"
    alt="Example calendar layout" class="calendar-example-img" loading="lazy"
  />
</details>

              <details class="faq-item">
                <summary>Is there anything else I should know?</summary>
                <p>Due to differences in monitor/phone screen resolution and rendering, the print/download you receive may differ slightly from what you see here.</p>
                <p>The print/download will contain an imperceptible watermark.</p>
              </details>
            </div>

          </div>
        </aside>

      </div>

    </div>
  </section>
</main>

<!-- =========================
     Footer
========================= -->
<div id="siteFooter"></div>

<!-- Toast notification container (pop-up messages after submit/errors) -->
<div class="toast" id="toast" role="status" aria-live="polite"></div>

<script>
/* Burger menu controller (same behaviour as index/gallery) */
(function(){
  const burger = document.querySelector('.burger');
  const menu = document.querySelector('.nav-menu');
  if(!burger || !menu) return;

  burger.addEventListener('click', () => {
    const open = menu.classList.toggle('open');
    burger.setAttribute('aria-expanded', open ? 'true' : 'false');
  });

  document.addEventListener('click', (e) => {
    if(menu.classList.contains('open') && !menu.contains(e.target) && !burger.contains(e.target)){
      menu.classList.remove('open');
      burger.setAttribute('aria-expanded','false');
    }
  });

  document.addEventListener('keydown', (e) => {
    if(e.key === 'Escape'){
      menu.classList.remove('open');
      burger.setAttribute('aria-expanded','false');
    }
  });
})();
</script>

<script>
/* Scroll reveal (adds "in" when elements enter viewport) */
(function(){
  const els = Array.from(document.querySelectorAll('.section, .panel, .card'))
    .filter(el => !el.classList.contains('reveal'));

  els.forEach(el => el.classList.add('reveal'));

  if(window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches){
    els.forEach(el => el.classList.add('in'));
    return;
  }

  const io = new IntersectionObserver((entries) => {
    entries.forEach(en => {
      if(en.isIntersecting){
        en.target.classList.add('in');
        io.unobserve(en.target);
      }
    });
  }, { threshold: 0.12, rootMargin: '0px 0px -8% 0px' });

  els.forEach(el => io.observe(el));
})();
</script>

<script>
/* =========================================================
   PRINT ENQUIRY BUILDER (multi-item + live preview + submit)
   ---------------------------------------------------------
   - Pulls printable titles from gallery.html (galleryData)
   - Allows user to add multiple items (image + size + frame)
   - Builds a readable text preview and hidden summary field
   - Submits via fetch() to Formspree, shows toast on success/fail
========================================================= */
(function(){
  const el = (id) => document.getElementById(id);
  const form = el('printsEnquiryForm');

  const itemsWrap = el('itemsWrap');
  const addItemBtn = el('addItemBtn');
  const itemsSummary = el('itemsSummary');

  const location = el('pCity');
  const name = el('pName');
  const phone = el('pPhone');
  const email = el('pEmail');
  const notes = el('pNotes');

  // Calendar checkbox (optional add-on enquiry)
  const calendar = el('pCalendar');

  const preview = el('enquiryPreview');
  const toast = el('toast');

  /* Allowed choices for size/type and framing */
  const TYPE_OPTIONS = [
    { v: "A4", t: "A4" },
    { v: "A3", t: "A3" },
    { v: "Digital", t: "Digital (high-res)" }
  ];
  const FRAMED_OPTIONS = [
    { v: "No", t: "No" },
    { v: "Yes", t: "Yes" }
  ];

  let GALLERY_TITLES = [];

  /* Toast helper (small message bar) */
  function showToast(msg){
    if(!toast) return;
    toast.textContent = msg;
    toast.classList.add('show');
    window.clearTimeout(showToast._t);
    showToast._t = window.setTimeout(() => toast.classList.remove('show'), 2600);
  }

  /* Load printable image titles from gallery.html’s embedded JSON
     - Filters out video-only entries (x.videos) so the dropdown stays “printable only” */
async function loadGalleryTitles(){
  try{
    const res = await fetch('gallery-data.json', { cache: 'no-store' });
    if(!res.ok) throw new Error('Failed to fetch gallery-data.json (HTTP ' + res.status + ')');

    const items = await res.json();

    GALLERY_TITLES = items
      .filter(x => x && x.title && !x.videos) // exclude video-only entries
      .map(x => x.title)
      .filter(Boolean);

    GALLERY_TITLES = Array.from(new Set(GALLERY_TITLES)); // de-dupe
  }catch(err){
    console.error(err);
    GALLERY_TITLES = [];
  }
}


  /* Build a <select> from either [{v,t}] objects or plain strings */
  function makeSelect(options, placeholder){
    const s = document.createElement('select');

    const ph = document.createElement('option');
    ph.value = "";
    ph.textContent = placeholder;
    s.appendChild(ph);

    options.forEach(o => {
      const opt = document.createElement('option');
      opt.value = o.v ?? o;
      opt.textContent = o.t ?? o;
      s.appendChild(opt);
    });

    return s;
  }

  /* Adds a new enquiry line item (image + type + frame + remove button) */
  function addItem(prefill){
    if(!itemsWrap) return;

    const row = document.createElement('div');
    row.className = 'item-row';

    /* Image selector is built from gallery titles */
    const imgSel = makeSelect(
      GALLERY_TITLES.map(t => ({ v: t, t })),
      GALLERY_TITLES.length ? "Select an image" : "Gallery unavailable"
    );
    imgSel.name = "item_image[]";
    imgSel.required = true;
    if(!GALLERY_TITLES.length) imgSel.disabled = true;

    const typeSel = makeSelect(TYPE_OPTIONS, "Image size/file");
    typeSel.name = "item_type[]";

    const frameSel = makeSelect(FRAMED_OPTIONS, "Frame required?");
    frameSel.name = "item_framed[]";

    // Default values (blank unless a prefill is explicitly passed)
    imgSel.value = prefill?.image ?? "";
    typeSel.value = prefill?.type ?? "";
    frameSel.value = prefill?.framed ?? "";

    /* Rule: if "Digital" is selected, frame is forced to "No" and locked */
    function syncFrameLock(){
      const isDigital = typeSel.value === "Digital";
      if(isDigital){
        frameSel.value = "No";
        frameSel.disabled = true;
      }else{
        frameSel.disabled = false;
      }
    }

    // Initial sync + on change
    syncFrameLock();
    typeSel.addEventListener('change', () => {
      syncFrameLock();
      build();
    });

    const actions = document.createElement('div');
    actions.className = 'item-actions';

    /* Remove button deletes this item row; ensures at least 1 row exists */
    const removeBtn = document.createElement('button');
    removeBtn.type = 'button';
    removeBtn.className = 'btn';
    removeBtn.textContent = 'Remove';
    removeBtn.addEventListener('click', () => {
      row.remove();
      if(itemsWrap.querySelectorAll('.item-row').length === 0){
        addItem();
      }
      build();
    });

    actions.appendChild(removeBtn);

    // Build on image/frame changes
    imgSel.addEventListener('change', build);
    frameSel.addEventListener('change', build);

    row.appendChild(imgSel);
    row.appendChild(typeSel);
    row.appendChild(frameSel);
    row.appendChild(actions);

    itemsWrap.appendChild(row);
    build();
  }

  /* Read all current item rows into a structured array */
  function getItems(){
    const rows = Array.from(itemsWrap?.querySelectorAll('.item-row') || []);
    return rows.map((r) => {
      const selects = r.querySelectorAll('select');
      return {
        image: selects[0]?.value || "",
        type: selects[1]?.value || "",
        framed: selects[2]?.value || ""
      };
    });
  }

  /* Builds:
     - the visible enquiry preview text
     - the hidden itemsSummary form field */
  function build(){
    const items = getItems();

    const lines = [
      `Name: ${name?.value?.trim() || ''}`,
      `Phone: ${phone?.value?.trim() || ''}`,
      `Email: ${email?.value?.trim() || ''}`,
      ``,
      `Items:`
    ];

    if(items.length === 0){
      lines.push(`- (none)`);
    } else {
      items.forEach((it, i) => {
        const framedLabel = (it.type === "Digital") ? "No" : (it.framed || "");
        lines.push(`${i+1}) ${it.image || '(select image)'} — ${it.type || ''} — Frame required: ${framedLabel}`);
      });
    }

    // Calendar line in preview
    lines.push(``);
    lines.push(`Calendar interest: ${calendar?.checked ? 'Yes (custom calendar – 12 images)' : 'No'}`);

    lines.push(
      ``,
      `Delivery location: ${location?.value?.trim() || ''}`,
      `Notes: ${notes?.value?.trim() || ''}`
    );

    const text = lines.join('\n');

    if(preview) preview.textContent = text;

    /* items_summary is used as a single plain-text field in the form submission */
    if(itemsSummary){
      itemsSummary.value = items
        .map((it, i) => {
          const framedLabel = (it.type === "Digital") ? "No" : (it.framed || "");
          return `${i+1}) ${it.image} — ${it.type} — Frame required: ${framedLabel}`;
        })
        .join('\n');
    }

    return text;
  }

  // Keep preview in sync with user input
  [location, name, phone, email, notes].forEach(x => x && x.addEventListener('input', build));
  calendar && calendar.addEventListener('change', build);

  // Add new item row
  if(addItemBtn){
    addItemBtn.addEventListener('click', () => addItem());
  }

  /* Form submit:
     - prevents default browser POST
     - validates items + HTML required fields
     - sends via fetch() to Formspree
     - resets UI + shows toast */
  if(form){
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const items = getItems();
      if(!items.length || !items.some(it => (it.image || '').trim())){
        showToast('Please add at least one image to your enquiry.');
        return;
      }

      if(!form.checkValidity()){
        form.reportValidity();
        return;
      }

      build();
      const formData = new FormData(form);

      try{
        const endpoint = form.getAttribute('action') || '';
        const res = await fetch(endpoint, {
          method: 'POST',
          headers: { 'Accept': 'application/json' },
          body: formData
        });
        if(!res.ok) throw new Error('Bad response');

        form.reset();
        if(itemsWrap) itemsWrap.innerHTML = '';
        addItem();
        build();

        showToast('Thank you for submitting your enquiry, I will get back to you as soon as possible with an update.');
      }catch(err){
        console.error(err);
        // Same message on failure: avoids exposing tech details to the user
        showToast('Thank you for submitting your enquiry, I will get back to you as soon as possible with an update.');
      }
    });
  }

  /* Initialise:
     - load titles from gallery
     - start with one empty item row
     - build initial preview */
  (async function init(){
    await loadGalleryTitles();
    if(itemsWrap) itemsWrap.innerHTML = '';
    addItem();  // start with 1 blank item
    build();
  })();

})();
</script>

<script>
/* =========================================================
   Framed mockup rotator
   - Reads image list from #framedData
   - Picks a random starting image
   - Rotates every 5s
   - If an image fails to load, it skips to the next
========================================================= */
(function(){
  const img = document.getElementById('framedPreviewImg');
  const desc = document.getElementById('framedPreviewDesc');
  const dataEl = document.getElementById('framedData');
  if(!img || !dataEl) return;

  let list = [];
  try{
    list = JSON.parse(dataEl.textContent).filter(Boolean);
  }catch(e){
    console.error('Invalid JSON in #framedData', e);
  }

  if(!list.length){
    img.style.display = 'none';
    if(desc) desc.textContent = 'No framed preview images listed yet.';
    return;
  }

  let i = Math.floor(Math.random() * list.length);

  function show(idx){
    img.src = list[idx];
  }

  img.addEventListener('error', () => {
    i = (i + 1) % list.length;
    show(i);
  });

  show(i);
  setInterval(() => {
    i = (i + 1) % list.length;
    show(i);
  }, 5000);
})();
</script>

<!-- Image protection “speed bumps” -->
<script src="protect-images.js"></script>

<!-- Calendar example modal (opened by “View example” link) -->
<div class="calendar-modal" id="calendarModal" aria-hidden="true">
  <div class="calendar-modal-inner">
    <button class="calendar-close" aria-label="Close">&times;</button>
    <img
      src="images/calendar-example.jpg"
      alt="Example astrophotography calendar layout"
      loading="lazy"
    />
  </div>
</div>

<script>
/* Calendar modal controller:
   - opens when clicking the “View example” link
   - closes on X button, clicking backdrop, or Escape */
(function(){
  const openBtn = document.getElementById('openCalendarExample');
  const modal = document.getElementById('calendarModal');
  const closeBtn = modal?.querySelector('.calendar-close');

  if(!openBtn || !modal) return;

  openBtn.addEventListener('click', (e) => {
    e.preventDefault();
    modal.classList.add('open');
    modal.setAttribute('aria-hidden', 'false');
  });

  closeBtn?.addEventListener('click', () => {
    modal.classList.remove('open');
    modal.setAttribute('aria-hidden', 'true');
  });

  modal.addEventListener('click', (e) => {
    if(e.target === modal){
      modal.classList.remove('open');
      modal.setAttribute('aria-hidden', 'true');
    }
  });

  document.addEventListener('keydown', (e) => {
    if(e.key === 'Escape'){
      modal.classList.remove('open');
      modal.setAttribute('aria-hidden', 'true');
    }
  });
})();
</script>
<script src="partials/partials.js"></script>

</body>
</html>
