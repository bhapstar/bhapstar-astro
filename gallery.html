<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gallery — bhapstar</title>
  <link rel="stylesheet" href="styles.css" />

  <style>
    /* Lightbox */
    .lightbox{
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,.92);
      z-index: 9999;
      padding: 18px;
    }
    .lightbox.open{ display: flex; }

    .lightbox-inner{
      position: relative;
      width: min(1200px, 100%);
      height: min(82vh, 900px);
      border-radius: 16px;
      overflow: hidden;
      background: rgba(0,0,0,.35);
      box-shadow: 0 20px 60px rgba(0,0,0,.45);
    }

    .lightbox-img{
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
      user-select: none;
      -webkit-user-drag: none;
      pointer-events: none; /* stops direct drag from the image */
    }

    /* Watermark overlay (bottom third) */
    .lightbox-watermark.lightbox-watermark{
  position: absolute;
  inset: 0;                /* fills the entire image */
  display: flex;
  align-items: center;     /* vertical centre */
  justify-content: center; /* horizontal centre */
  pointer-events: none;
}
    .lightbox-watermark span{
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      text-transform: lowercase;
      letter-spacing: .12em;
      font-weight: 700;
      font-size: clamp(40px, 10vw, 120px);
      opacity: .05;          /* <-- adjust watermark strength here */
      color: #fff;
      transform: rotate(-12deg);
      text-shadow: 0 8px 22px rgba(0,0,0,.35);
      mix-blend-mode: screen; /* keeps it light */
      user-select: none;
      white-space: nowrap;
    }

    /* Close button */
    .lightbox-close{
      position: absolute;
      top: 12px;
      right: 12px;
      width: 42px;
      height: 42px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.35);
      color: #fff;
      display: grid;
      place-items: center;
      cursor: pointer;
      backdrop-filter: blur(6px);
    }
    .lightbox-close:hover{ background: rgba(0,0,0,.55); }

    /* Small caption */
    .lightbox-meta{
      position: absolute;
      left: 14px;
      bottom: 14px;
      right: 14px;
      display: flex;
      gap: 10px;
      align-items: flex-end;
      justify-content: space-between;
      pointer-events: none;
    }
    .lightbox-meta .title{
      font-weight: 650;
      font-size: 14px;
      opacity: .95;
      color: rgba(255,255,255,.92);
      text-shadow: 0 8px 22px rgba(0,0,0,.55);
      max-width: 70%;
      line-height: 1.25;
    }
    .lightbox-meta a{
      pointer-events: auto;
      font-size: 12px;
      opacity: .9;
      color: rgba(255,255,255,.92);
      text-decoration: none;
      border-bottom: 1px solid rgba(255,255,255,.35);
    }
    .lightbox-meta a:hover{ opacity: 1; border-bottom-color: rgba(255,255,255,.75); }

    /* Prevent background scroll when lightbox open */
    body.noscroll{ overflow: hidden; }
  </style>
</head>
<body>

<header>
  <div class="wrap">
    <div class="navbar">
      <div></div>

      <a class="brand" href="index.html" aria-label="bhapstar home">
        <span class="mark">bhapstar</span>
        <span class="sub">astrophotography</span>
      </a>

      <button class="burger" aria-label="Menu" aria-expanded="false">
        <span></span><span></span><span></span>
      </button>

      <nav class="nav-menu" aria-label="Site">
        <a href="index.html">Home</a>
        <a class="active" href="gallery.html">Gallery</a>
        <a href="prints.html">Prints</a>
        <a href="gear.html">Gear</a>
        <a href="about.html">About</a>
      </nav>
    </div>
  </div>
</header>

<main>
<section class="section">
<div class="wrap">

  <div class="section-head gallery-head">
<div class="gallery-topline">
  <h2>Gallery</h2>
</div>

    <p class="gallery-intro">
      All images shown here are my own, created through patient hours of long-exposure imaging under dark, often cold night skies, followed by careful processing to reveal faint structures and subtle detail hidden in the data.
    </p>

<div class="gallery-filter" role="group" aria-label="Gallery filter">
  <label class="gallery-filter-label" for="typeFilter">View gallery images by type</label>

  <div class="gallery-filter-row">
    <select id="typeFilter" class="gallery-filter-select">
      <option value="all">All</option>
      <option value="galaxies">Galaxies</option>
      <option value="nebulae">Nebulae</option>
      <option value="star-clusters">Star Clusters</option>
      <option value="others">Others</option>
    </select>
 <div class="gallery-filter-spacer"></div>
    <button id="viewToggle" class="view-toggle" type="button" aria-pressed="false">
      List view
    </button>
  </div>
</div>

<p class="gallery-hint">
  Click any image to view fullscreen.
</p>
  </div>


  <!-- THIS must be outside the section-head -->
  <div id="galleryGrid" class="grid"></div>

</div>


</section>

</main>

<footer>
  <div class="wrap">
    <div class="footer-links">
      <span>© <span id="y"></span> bhapstar astrophotography</span>
      <span>·</span>
      <a href="gallery.html">Gallery</a>
      <span>·</span>
      <a href="prints.html">Prints</a>
      <span>·</span>
      <a href="gear.html">Gear</a>
      <span>·</span>
      <a href="about.html">About</a>
      <a href="https://www.instagram.com/bhapstar/"
   target="_blank"
   rel="noopener"
   aria-label="Instagram"
   class="social-icon">
  <svg viewBox="0 0 24 24" width="18" height="18" fill="none"
       xmlns="http://www.w3.org/2000/svg">
    <rect x="2" y="2" width="20" height="20" rx="5"
          stroke="currentColor" stroke-width="2"/>
    <circle cx="12" cy="12" r="5"
            stroke="currentColor" stroke-width="2"/>
    <circle cx="17.5" cy="6.5" r="1.2"
            fill="currentColor"/>
  </svg>
</a>
    </div>
  </div>
</footer>
<script>(function(){var y=document.getElementById('y'); if(y) y.textContent=new Date().getFullYear();})();</script>

<script>
(function(){
  const burger = document.querySelector('.burger');
  const menu = document.querySelector('.nav-menu');
  if(!burger || !menu) return;

  burger.addEventListener('click', () => {
    const open = menu.classList.toggle('open');
    burger.setAttribute('aria-expanded', open ? 'true' : 'false');
  });

  document.addEventListener('click', (e) => {
    if(menu.classList.contains('open') && !menu.contains(e.target) && !burger.contains(e.target)){
      menu.classList.remove('open');
      burger.setAttribute('aria-expanded','false');
    }
  });

  document.addEventListener('keydown', (e) => {
    if(e.key === 'Escape'){
      menu.classList.remove('open');
      burger.setAttribute('aria-expanded','false');
    }
  });
})();
</script>

<!-- Embedded gallery data -->
<script id="galleryData" type="application/json">
[
  {
    "file": "images/RN.jpg",
    "title": "Rosette Nebula (NGC 2244)",
    "desc": "A vast, expanding cloud of ionised hydrogen surrounding a young open star cluster at its core. Intense radiation from newly formed stars carves cavities into the surrounding gas, revealing the fragile balance between stellar birth and destruction.",
    "alt": "Rosette Nebula",
    "type": "nebulae"
  },
  {
    "file": "images/JFN.jpg",
    "title": "Jellyfish Nebula (IC 443)",
    "desc": "The remnants of a massive stellar explosion, where an expanding supernova shockwave collides with surrounding molecular clouds. Filamentary structures trace the violence of the event, frozen in motion thousands of years after the star’s death.",
    "alt": "Jellyfish Nebula",
    "type": "nebulae"
  },
  {
    "file": "images/Xmas.jpg",
    "title": "Christmas Tree Nebula (NGC 2264)",
    "desc": "A rich and chaotic star-forming region where glowing emission nebulae intertwine with dense, cold dust. The Cone Nebula stands as a towering pillar of molecular gas, sculpted by ultraviolet radiation from nearby massive stars.",
    "alt": "NGC 2264 (Cone Nebula & Christmas Tree)",
    "type": "nebulae"
  },
  {
    "file": "images/MHN.jpg",
    "title": "Monkey Head Nebula (NGC 2174)",
    "desc": "A luminous star-forming region shaped by powerful radiation and stellar winds from young, massive stars. Dark dust lanes cut through glowing hydrogen, giving rise to the nebula’s distinctive silhouette against the Orion constellation.",
    "alt": "Monkey Head Nebula",
    "type": "nebulae"
  },
  {
    "file": "images/Pleiades.jpeg",
    "title": "Pleiades (M45)",
    "desc": "A young open star cluster dominated by hot, blue stars, drifting through faint interstellar dust that reflects their light. Often mistaken for a nebula, the delicate blue haze is a foreground veil rather than material born with the stars themselves.",
    "alt": "Pleiades star cluster",
    "type": "star-clusters"
  },
  {
   "file": "images/Orion Nebula.jpg",
   "title": "Orion Nebula (M42)",
   "desc": "The closest large star-forming region to Earth, glowing just below Orion’s Belt. Visible to the naked eye, this vast stellar nursery offers a rare glimpse into the processes that give rise to new stars and planetary systems.",
   "alt": "The Orion Nebula",
   "type": "nebulae"
  },
   {
   "file": "images/Andromeda.jpg",
   "title": "Andromeda Galaxy (M31)",
   "desc": "A vast spiral galaxy beyond our own, captured as its ancient light travels over two million years through intergalactic space. A reminder that the Milky Way is not alone, but one of countless island universes drifting through the dark.",
   "alt": "Andromeda",
   "type": "galaxies"
  },
   {
   "file": "images/Flame&Horsehead.jpg",
   "title": "Flame (NGC 2024) and Horsehead (B33) Nebulae",
   "desc": "Dark molecular dust and glowing hydrogen clouds shaped by intense radiation from nearby young stars, suspended along the edge of Orion’s Belt. A region where star formation, erosion, and shadow coexist in delicate balance",
   "alt": "Flame&Horsehead",
   "type": "nebulae"
  },
    {
   "file": "images/Eagle Nebula.jpeg",
   "title": "Eagle Nebula (M16)",
   "desc": "A vast stellar nursery where dense clouds of gas and dust give rise to new generations of stars. The iconic Pillars of Creation rise from the nebula’s core, slowly eroded by radiation from the young stars forming within",
   "alt": "The Eagle Nebula",
   "type": "nebulae"
  },
  {
    "file": "images/Moon.jpeg",
    "title": "The Moon",
    "desc": "Earth’s only natural satellite, its heavily cratered surface shaped by billions of years of impacts and geological change. Seen here in fine detail, it serves as both a familiar presence and a reminder of our planet’s place in space.",
    "alt": "The Moon",
    "type": "others"
  },
  {
   "file": "images/Bodes & Cigar.jpeg",
   "title": "Bode's (M81) and Cigar (M82) Galaxies",
   "desc": "A closely interacting pair of galaxies in Ursa Major, their gravitational encounter leaving lasting marks on both systems. While M81 retains its elegant spiral structure, M82 shows intense starburst activity triggered by their past interaction.",
   "alt": "Bodes & Cigar",
   "type": "galaxies"
  },
   {
   "file": "images/Triangulum.jpg",
   "title": "Triangulum Galaxy (M33)",
   "desc": "A nearby spiral galaxy in the Local Group, smaller and more diffuse than the Milky Way. Its faint arms are rich with glowing star-forming regions, scattered across a delicate and expansive disk.",
   "alt": "Triangulum",
   "type": "galaxies"
  },
   {
   "file": "images/MilkyWay&Me.jpg",
   "title": "The Milky Way and Me",
   "desc": "A quiet moment for me beneath the arc of the Milky Way, standing against the glowing structure of our home galaxy. A human scale set against cosmic distances, where Earth becomes part of the wider scene rather than its centre.",
   "alt": "MilkyWayMe",
   "type": "others"
  }
]
</script>

<!-- Lightbox markup -->
<div id="lightbox" class="lightbox" aria-hidden="true" role="dialog" aria-label="Image viewer">
  <div class="lightbox-inner">
    <button class="lightbox-close" id="lbClose" aria-label="Close">✕</button>
    <img class="lightbox-img" id="lbImg" alt="" src="" />
    <div class="lightbox-watermark" aria-hidden="true"><span>bhapstar</span></div>
    <div class="lightbox-meta" aria-hidden="false">
      <div class="title" id="lbTitle"></div>
    </div>
  </div>
</div>

<script>
(function(){
  const grid = document.getElementById('galleryGrid');
  const dataEl = document.getElementById('galleryData');
  const lb = document.getElementById('lightbox');
  const lbImg = document.getElementById('lbImg');
  const lbTitle = document.getElementById('lbTitle');
  const lbClose = document.getElementById('lbClose');
  const typeFilter = document.getElementById('typeFilter');
  const viewToggle = document.getElementById('viewToggle');

  // ✅ do NOT touch grid until we've confirmed it exists
  if(!grid || !dataEl || !lb || !lbImg || !lbTitle || !lbClose) return;

  const items = JSON.parse(dataEl.textContent);

  function esc(s){
    return String(s ?? "")
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  function openLightbox(item){
    lbImg.src = item.file;
    lbImg.alt = item.alt || item.title || 'Astrophotography image';
    lbTitle.textContent = item.title || '';

    lb.classList.add('open');
    lb.setAttribute('aria-hidden','false');
    document.body.classList.add('noscroll');
  }

  function closeLightbox(){
    lb.classList.remove('open');
    lb.setAttribute('aria-hidden','true');
    document.body.classList.remove('noscroll');

    lbImg.src = "";
    lbImg.alt = "";
    lbTitle.textContent = "";
  }

  function render(){
    const selected = (typeFilter && typeFilter.value) ? typeFilter.value : 'all';
    const filtered = (selected === 'all')
      ? items
      : items.filter(it => (it.type || 'others') === selected);

    grid.innerHTML = filtered.map((item) => {
      const idx = items.findIndex(x => x.file === item.file);

      return `
        <a class="card" href="${esc(item.file)}" data-idx="${idx}" aria-label="${esc(item.title || item.alt)}">
          <img src="${esc(item.file)}" alt="${esc(item.alt)}" loading="lazy">
          <div class="cap">
            <div class="t">${esc(item.title)}</div>
            <div class="d">${esc(item.desc)}</div>
          </div>
        </a>
      `;
    }).join('');
  }

// ✅ Mobile: always grid view (ignore saved preference)
const isMobile = window.matchMedia('(max-width: 720px)').matches;

if(isMobile){
  grid.classList.remove('list-view');
  localStorage.setItem('galleryView', 'grid'); // optional: keep it consistent
  if(viewToggle){
    viewToggle.textContent = 'List view';
    viewToggle.setAttribute('aria-pressed','false');
  }
} else {
  // Desktop/tablet: restore preference
  const savedView = localStorage.getItem('galleryView');
  if(savedView === 'list'){
    grid.classList.add('list-view');
    if(viewToggle){
      viewToggle.textContent = 'Grid view';
      viewToggle.setAttribute('aria-pressed','true');
    }
  } else {
    grid.classList.remove('list-view');
    if(viewToggle){
      viewToggle.textContent = 'List view';
      viewToggle.setAttribute('aria-pressed','false');
    }
  }
}


  // initial render
  render();

  // dropdown filter
  if(typeFilter){
    typeFilter.addEventListener('change', render);
  }

  // list/grid toggle
if(viewToggle){
  viewToggle.addEventListener('click', () => {
    if(window.matchMedia('(max-width: 720px)').matches) return; // do nothing on mobile

    const isList = grid.classList.toggle('list-view');
    viewToggle.textContent = isList ? 'Grid view' : 'List view';
    viewToggle.setAttribute('aria-pressed', isList ? 'true' : 'false');
    localStorage.setItem('galleryView', isList ? 'list' : 'grid');
  });
}


  // click image => open lightbox
  grid.addEventListener('click', (e) => {
    const a = e.target.closest('a.card');
    if(!a) return;
    e.preventDefault();
    const idx = Number(a.getAttribute('data-idx'));
    const item = items[idx];
    if(item) openLightbox(item);
  });

  lbClose.addEventListener('click', closeLightbox);

  // click outside closes
  lb.addEventListener('click', (e) => {
    if(e.target === lb) closeLightbox();
  });

  document.addEventListener('keydown', (e) => {
    if(e.key === 'Escape' && lb.classList.contains('open')) closeLightbox();
  });
})();
</script>


<script>
/* Scroll reveal (adds "in" when elements enter viewport) */
(function(){
  const els = Array.from(document.querySelectorAll('.section, .panel, .card'))
    .filter(el => !el.classList.contains('reveal'));

  els.forEach(el => el.classList.add('reveal'));

  if(window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches){
    els.forEach(el => el.classList.add('in'));
    return;
  }

  const io = new IntersectionObserver((entries) => {
    entries.forEach(en => {
      if(en.isIntersecting){
        en.target.classList.add('in');
        io.unobserve(en.target);
      }
    });
  }, { threshold: 0.12, rootMargin: '0px 0px -8% 0px' });

  els.forEach(el => io.observe(el));
})();
</script>
<script src="protect-images.js"></script>
</body>
</html>
